# sudoku

## 仕様
ナンプレ攻略プログラム

手入力またはテキストデータから読み込んだナンプレの盤面情報から、理詰めでマスを埋める。

大抵のナンプレなら解ける。

c言語で記述。`ncurses`ライブラリを利用して表示を行なっている。

### ファイル一覧
+ clone時

```
sudoku
|
|- README.md
|- makefile
|
|- source
|  |- calc.c
|  |- calc.h
|  |- fileio.c
|  |- fileio.h
|  |- log.c
|  |- main.c
|  |- menu.c
|  |- menu.h
|  |- setting.c
|  |- setting.h
|
|- np
   |- demo1.dat
   |- demo2.dat
   |- save
```

+ コンパイル後

フォルダ`sudoku`の中に実行ファイル`sudokuSolve`が追加される

### ダウンロード・コンパイル
（C言語を使える環境で）以下のコマンドを順番に打ち込む。
```
$ git clone https://github.com/oha-yashi/sudoku
$ cd sudoku
$ make compile
```
もし`$ make compile`でエラーが出る場合は、`makefile`の中でインデントになっているところを全て、空白ではなく「Tab」に置き換える。

```
=============
compile end!!
$ make do
to start
=============
```
が出力されれば成功。`sudokuSolve`ができているはず。

### 実行
```
$ make do
```
で実行

### ウィンドウサイズの操作
OS Xの場合(?)
```
$ make size
```
を実行するとターミナルのサイズがいい感じになる。フォントサイズがデフォルトの11から12になる。
`makefile`を見てもらえばわかるのだが、AppleScriptを実行している。


```
$ make resize
```
を実行するとフォントサイズが11に戻る。

## 操作

### 基本画面

![1](https://user-images.githubusercontent.com/54564869/77670596-57ee0300-6f7e-11ea-9edc-231b85dce186.png)

(画像は開発中のもので、実際の画面と異なる場合があります（笑）)

+ `$ $`(赤) --- 現在のマス
+ `! !`(青) --- 候補が2つのマス
+ `? ?`(緑) --- 候補が3つのマス
+ `[n]` --- 確定したマス
+ `[ ]` --- 空きマス
+ `now( 1: 020c)[_] < 2 3 9 >` --- 現在のマスの番号とデータ(16進表示), マスの状態, 候補一覧

### キー入力

+ [↑][↓][←][→] --- マス移動
+ 数字[0~9] --- 数字を確定させる。[0]は[スペース]と同じ
+ [スペース] --- マス移動(一つずつ隣に移動)
+ `k` --- `i`が候補となるマスを順に表示
+ `c` --- 現在のマスの候補を無理やり変える
+ `b` --- 1つ前の状態に戻す
+ `d` --- 現在のマスを消去
+ `x` --- リセット
+ `i` --- フォルダ`np`内の指定ファイルから読み込み
+ `w` --- セーブファイルに記録
+ `r` --- セーブファイルから読み込み
+ `q` --- 終了

### ファイルの形式

フォルダ`np`にファイルを入れることで、盤面を一気に読み込んだり、出力保存したりできる。

拡張子はなんでもいい。テキストとして読み込めれば。

#### np/demo1.dat

`demo1.dat`は、0~9の数字の並びで示す盤面情報のサンプル。

1行目は、読み込みの際に使う変換指定子を入れる。ここでは「1桁の10進整数」を示す`%1d`を書く。（この後は改行じゃなくて空白でも良い）

2行目以降は81個の数字を入れる。`0`は空きマス、`1~9`は盤面の（確定している）数字。

「1桁の数字が81個」あれば良いので、途中の改行や空白はなくても良いし、増えても良い。Tabもアリ。ただし数字や改行等以外のものが入ると読み込みが途切れてしまう。

「数字81個」以降は何を書いてもいい。そもそも読み込まれないので。

#### np/demo2.dat

`demo2.dat`は、16進数で示された盤面情報のサンプル。

1行目の変換指定子は`%x`である（`%4x`でもいいけど、空白区切りするので桁数指定は要らないし、）。

`save.dat`も、セーブ機能で作られる同様の形式のファイルである。

## ログの取得

```
$ make log
```
で`log.c`をコンパイル。フォルダ`sudoku`の中にディレクトリ`logdata`が追加される。

`logdata`に、`np`に入れるのと同じ形式の盤面データ`filename`(←命名自由)を入れた上で
```
./log filename
```
を実行すると、解答ステップを書き出しながら、`logdata/filename_log`に解答ログを書き出す。

## その他

プログラム本体について詳しくは[ブログ](https://o-treetree.hatenablog.com/entry/sudoku-4)で書く。

## ライセンス

> Copyright (c) 2020 oha-yashi
> 
> Released under the MIT license
> 
> https://opensource.org/licenses/mit-license.php
